{% extends 'base.html' %} 

{% block title %} 
Статьи
{% endblock %}

{% block content %}
<div class="container">
        <h1 class="section-title">Статьи</h1>
        <div class="blog-cards">
            {% for article in articles %}
            <div class="blog-card">
                <div class="card-header">
                    <div>
                        <h2 class="card-title">{{ article.title }}</h2>
                        <div class="meta-info">
                            {% if article.created_date == today %}
                                <span class="new-post">Новое!</span>
                            {% endif %}
                            <span class="tag">{{article.category}}</span>
                            <span class="date">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                                </svg>
                                 {{ article.created_date | russian_date }}
                            </span>
                        </div>
                    </div>
                </div>
                <div class="pattern"></div>
                <div class="card-content">
                    <div class="description">
                        {{article.text}}
                    </div>
                    <div class="btn-wrapper">
                        <a href="{{url_for('article_content', id=article.id)}}" class="read-more">
                            Читать далее
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3" />
                            </svg>
                        </a>
                        <button class="bookmark-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        const bookmarkBtns = document.querySelectorAll('.bookmark-btn');
        const readMoreBtns = document.querySelectorAll('.read-more');
        const blogCards = document.querySelectorAll('.blog-card');

        // Add a subtle parallax effect to the blog cards on mousemove
        blogCards.forEach(card => {
            card.addEventListener('mousemove', function(e) {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const xPercent = x / rect.width - 0.5;
                const yPercent = y / rect.height - 0.5;
                
                const cardHeader = card.querySelector('.card-header');
                const cardContent = card.querySelector('.card-content');
                
                cardHeader.style.transform = `rotateX(${yPercent * -10}deg) rotateY(${xPercent * 10}deg) translateZ(0)`;
                if (card.matches(':hover')) {
                    cardHeader.style.transform += ' translateY(-80px)';
                }
                
                cardContent.style.boxShadow = `${xPercent * -15}px ${yPercent * -15}px 30px rgba(0,0,0,0.1) inset`;
            });
            
            card.addEventListener('mouseleave', function() {
                const cardHeader = card.querySelector('.card-header');
                const cardContent = card.querySelector('.card-content');
                
                cardHeader.style.transform = '';
                cardContent.style.boxShadow = '';
                
                setTimeout(() => {
                    if (card.matches(':hover')) return;
                    cardHeader.style.transition = 'var(--transition)';
                    cardContent.style.transition = 'var(--transition)';
                }, 100);
            });
        });

        // Bookmark functionality
        bookmarkBtns.forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                this.classList.toggle('active');
                
                // Add pulse animation when bookmarking
                if (this.classList.contains('active')) {
                    this.classList.add('pulse');
                    setTimeout(() => {
                        this.classList.remove('pulse');
                    }, 1500);
                }
            });
        });

        // Prevent form submission
        readMoreBtns.forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                // In a real app, this would navigate to the article
                // For this demo, we just add a subtle animation
                this.classList.add('pulse');
                setTimeout(() => {
                    this.classList.remove('pulse');
                }, 1500);
            });
        });

        // Add touch support for mobile devices
        blogCards.forEach(card => {
            let touchStartTime;
            
            card.addEventListener('touchstart', function() {
                touchStartTime = new Date().getTime();
            });
            
            card.addEventListener('touchend', function() {
                const touchEndTime = new Date().getTime();
                const touchDuration = touchEndTime - touchStartTime;
                
                // If it's a quick tap (less than 200ms), toggle the card state
                if (touchDuration < 200) {
                    const cardHeader = this.querySelector('.card-header');
                    const cardContent = this.querySelector('.card-content');
                    
                    if (cardContent.style.transform === 'translateY(0px)') {
                        cardContent.style.transform = 'translateY(100%)';
                        cardHeader.style.transform = 'rotateX(0deg) translateY(0)';
                    } else {
                        cardContent.style.transform = 'translateY(0px)';
                        cardHeader.style.transform = 'rotateX(10deg) translateY(-80px)';
                    }
                }
            });
        });
    </script>

{% endblock %}